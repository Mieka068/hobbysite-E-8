{% extends "base.html" %}

{% block title %}Merchandise Store{% endblock %}

{% block content %}
    <h1 style="text-align: center;">ğŸ›ï¸ Merchandise Store</h1>

    <!-- Top Action Buttons -->
    {% if user.is_authenticated %}
        <div style="text-align: center; margin: 20px 0;">
            <a href="{% url 'merchstore:add_product_view' %}" class="solid-blue-button">+ Sell a Product</a>
            <a href="{% url 'merchstore:cart_view' %}" class="solid-blue-button">ğŸ›’ View Cart</a>
            <a href="{% url 'merchstore:transactions_view' %}" class="solid-blue-button">ğŸ“¦ View Transactions</a>
        </div>
    {% endif %}

    <!-- Authenticated User Sections -->
    {% if user.is_authenticated %}
        <!-- Your Listings -->
        <section>
            <h2 style="margin-top: 40px;">ğŸ“Œ Your Listings</h2>
            {% if owned_products %}
                <div class="product-grid">
                    {% for product in owned_products %}
                        <a href="{% url 'merchstore:detail_view' product.id %}" class="grey-box">
                            <h3>{{ product.name }}</h3>
                        </a>
                    {% endfor %}
                </div>
            {% else %}
                <p style="text-align: center; font-style: italic;">You haven't listed anything yet.</p>
            {% endif %}
        </section>

        <!-- Other Products -->
        <section>
            <h2 style="margin-top: 40px;">ğŸ›ï¸ Explore Products</h2>
            {% if other_products %}
                <div class="product-grid">
                    {% for product in other_products %}
                        <a href="{% url 'merchstore:detail_view' product.id %}" class="grey-box">
                            <h3>{{ product.name }}</h3>
                        </a>
                    {% endfor %}
                </div>
            {% else %}
                <p style="text-align: center; font-style: italic;">No other products available right now.</p>
            {% endif %}
        </section>

    {% else %}
        <!-- Guest View -->
        <p style="text-align: center; margin-top: 30px;">
            You are currently logged out. <a href="{% url 'login' %}">Login?</a>
        </p>

        <h2 style="margin-top: 40px;">ğŸ›ï¸ Available Products</h2>
        {% if all_products %}
            <div class="product-grid">
                {% for product in all_products %}
                    <a href="{% url 'merchstore:detail_view' product.id %}" class="grey-box">
                        <h3>{{ product.name }}</h3>
                        <p class="card-meta">Click to view</p>
                    </a>
                {% endfor %}
            </div>
        {% else %}
            <p style="text-align: center; font-style: italic;">No products available.</p>
        {% endif %}
    {% endif %}
{% endblock %}
